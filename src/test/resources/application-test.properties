# Configura√ß√£o para testes com H2 (em mem√≥ria)
spring.application.name=wallet-test

# H2: Banco de dados em mem√≥ria com suporte a Locking
# MODE=PostgreSQL: Simula comportamento do PostgreSQL (incluindo FOR UPDATE)
# LOCK_TIMEOUT=10000: Timeout de 10s para aguardar locks
# DB_CLOSE_DELAY=-1: Mant√©m banco na mem√≥ria entre conex√µes
spring.datasource.url=jdbc:h2:mem:testdb;MODE=PostgreSQL;LOCK_TIMEOUT=10000;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# H2: Console para debugging (opcional)
spring.h2.console.enabled=true

# JPA / Hibernate (Criar schema automaticamente para testes)
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect

# üîí CRITICAL: Connection Pool com 1 conex√£o por thread
# Isso garante que cada thread ter√° sua pr√≥pria transa√ß√£o isolada
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000

# Desabilita auto-commit para for√ßar transa√ß√µes expl√≠citas
spring.datasource.hikari.auto-commit=false
